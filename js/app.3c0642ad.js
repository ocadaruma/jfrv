(function(){"use strict";var e={8617:function(e,t,a){var n=a(9963),l=a(6252);function r(e,t){const a=(0,l.up)("router-view");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(a,null,{default:(0,l.w5)((({Component:e})=>[((0,l.wg)(),(0,l.j4)(l.Ob,null,[((0,l.wg)(),(0,l.j4)((0,l.LL)(e)))],1024))])),_:1})])}var o=a(3744);const i={},s=(0,o.Z)(i,[["render",r]]);var u=s,d=a(2201),c=(a(8675),a(3462),a(7380),a(1118),a(2262)),f=a(3577),h=a(6209),v=a(9118);const p=e=>((0,l.dD)("data-v-4695d0c5"),e=e(),(0,l.Cn)(),e),m={class:"font-mono"},g={class:"h-12 fixed top-0 left-0 z-50 w-full bg-white border-b border-slate-400"},b={class:"h-8 m-2 flex space-x-2"},w=p((()=>(0,l._)("span",{class:"align-middle"},"execution sample",-1))),y=p((()=>(0,l._)("span",{class:"align-middle"},"JFR query",-1))),_=p((()=>(0,l._)("span",{class:"align-middle"},"offcpu (jvm-blocking-monitor)",-1))),x=p((()=>(0,l._)("a",{href:"https://github.com/ocadaruma/jfrv",target:"_blank",class:"absolute h-7 border-2 border-slate-500 pl-2 pr-2 right-2"},"ðŸ“– docs",-1))),k={class:"fixed top-12 left-0 right-0 bottom-0"};function S(e,t){const a=(0,l.up)("router-link");return(0,l.wg)(),(0,l.iD)("div",m,[(0,l._)("div",g,[(0,l._)("nav",b,[(0,l.Wm)(a,{to:"/execution-sample",class:"hover:bg-slate-300 flex-none pl-2 pr-2 h-7 text-sm text-center border-2 rounded border-slate-400"},{default:(0,l.w5)((()=>[w])),_:1}),(0,l.Wm)(a,{to:"/jfr-query",class:"hover:bg-slate-300 flex-none pl-2 pr-2 h-7 text-sm text-center border-2 rounded border-slate-400"},{default:(0,l.w5)((()=>[y])),_:1}),(0,l.Wm)(a,{to:"/jbm",class:"hover:bg-slate-300 flex-none pl-2 pr-2 h-7 text-sm text-center border-2 rounded border-slate-400"},{default:(0,l.w5)((()=>[_])),_:1}),x])]),(0,l._)("div",k,[(0,l.WI)(e.$slots,"default",{},void 0,!0)])])}const j={},C=(0,o.Z)(j,[["render",S],["__scopeId","data-v-4695d0c5"]]);var H=C,R=a(2482);a(2801);const U="__flame_graph__",z={chartId:"flame-graph",highlightId:"highlight",highlightTextId:"highlight-text",statusId:"status",font:"12px Verdana, sans-serif",colorPalette:{Interpreted:{baseHex:11723186,rMix:20,gMix:20,bMix:20},JitCompiled:{baseHex:5300560,rMix:30,gMix:30,bMix:30},Inlined:{baseHex:5295308,rMix:30,gMix:30,bMix:30},Native:{baseHex:14768730,rMix:30,gMix:40,bMix:40},Cpp:{baseHex:13158460,rMix:30,gMix:30,bMix:10},Kernel:{baseHex:14777600,rMix:30,gMix:30,bMix:0},C1Compiled:{baseHex:13428864,rMix:20,gMix:20,bMix:20},Unknown:{baseHex:0,rMix:0,gMix:0,bMix:0}}};class M{constructor(e,t){(0,R.Z)(this,"delegate",void 0),(0,R.Z)(this,"objectElement",void 0),this.delegate=e,this.objectElement=t}static open(e){const t=`/jfrv/${vt.resolve({name:"flame-graph"}).href}`,a=window.open(t,"_blank");a&&(a.onload=()=>{const t=a.document.createElement("object");t.type="application/json",t.data=`data:application/json;base64,${btoa(JSON.stringify(e))}`,t.id=U,t.style.display="none",a.document.body.appendChild(t)})}static async flameGraph(){const e=window.document.getElementById(U),t=await fetch(e.data),a=await t.json();return a}}const W={class:"fixed top-12 left-0 right-0 h-12 bg-neutral-100 z-40 border-b border-slate-400 p-2"},E=(0,l._)("span",{class:"h-7 ml-2"},"thread name:",-1),D=(0,l._)("span",{class:"h-7 ml-2"},"stack trace:",-1),I=(0,l._)("span",{class:"h-7 ml-2"},"&& !",-1),B=["disabled"],T={class:"fixed top-24 left-0 right-0 h-8 bg-neutral-50 z-40 border-b border-slate-400 p-0.5"},A=["disabled"],O=["disabled"],$=["disabled"],F=(0,l._)("span",{id:"time-label",class:"text-xs relative hidden",style:{transform:"translateX(-100%)"}},null,-1),q=[F],P={class:"absolute top-20 right-0 left-0 bottom-0"},X={class:"w-full h-full"},Z={key:0},N={key:0},V={key:1},L={class:"w-full h-full"},G={class:"p-2"},J={class:"h-full p-2 overflow-auto"},K={class:"table-auto whitespace-nowrap"},Y=(0,l._)("td",{class:"text-right"},"timestamp :",-1),Q=(0,l._)("td",{class:"text-right"},"os thread id :",-1),ee={key:0,class:"fixed w-72 h-24 bg-neutral-200 border-neutral-500 p-2 border-2 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},te={key:1,class:"fixed w-72 h-24 bg-neutral-200 border-neutral-500 p-2 border-2 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"};var ae=(0,l.aZ)({__name:"ExecutionSample",setup(e){const t={defaultMargin:1,fontSize:14,headerConfig:{borderWidth:1,borderColorRgbHex:7368816,elementId:"header",paneId:"header-pane",overlayElementId:"header-overlay"},sampleViewConfig:{elementId:"thread-chart-sample-view",paneId:"chart-pane",overlayElementId:"chart-overlay",sampleRenderSize:{width:6,height:8},backgroundRgbHex:16119285},threadStateColorConfig:{stateRunnableRgbHex:7125534,stateSleepingRgbHex:8737986,stateUnknownRgbHex:7302514,stateHiddenRgbHex:12895428},overlayConfig:{rowHighlightArgbHex:1077952576,sampleHighlightRgbHex:15745140,timestampStrokeWidth:.5},axisConfig:{labelElementId:"time-label"}},r=(0,c.iH)(),o=(0,c.iH)(),i=(0,c.iH)(),s=(0,c.iH)(),u=(0,c.iH)(),d=(0,c.iH)(),p=(0,c.iH)(),m=(0,c.iH)(),g=(0,c.iH)(),b=(0,c.iH)(),w=(0,c.iH)(),y=(0,c.iH)(),_=(0,c.iH)(),x=(0,c.iH)(),k=(0,c.iH)(),{getRootProps:S,getInputProps:j,isDragActive:C,open:R}=(0,v.u)({onDrop:oe,multiple:!1,noClick:!0,noKeyboard:!0,accept:[".jfr",".gz"]});function U(e){return void 0!==e&&e?.length>0?e:null}function F(){_.value&&r.value?.apply_filter({threadNameRegex:U(b.value),stackTraceMatchRegex:U(w.value),stackTraceRejectRegex:U(y.value)})}function ae(){o.value=r.value?.on_chart_click()}function ne(e){r.value?.on_header_mouse_move(e.clientX-p.value.getBoundingClientRect().x,e.clientY-p.value.getBoundingClientRect().y)}function le(e){r.value?.on_chart_mouse_move(e.clientX-m.value.getBoundingClientRect().x,e.clientY-m.value.getBoundingClientRect().y)}function re(){r.value?.on_mouse_out()}async function oe(e,t){_.value="loading";const a=e[0],n=await a.arrayBuffer(),l=new Uint8Array(n);await de(a.name,l)}async function ie(){_.value="loading";const e=await fetch("/jfrv/demo.jfr"),t=await e.arrayBuffer(),a=new Uint8Array(t);await de("demo.jfr",a)}async function se(e){let a=t.sampleViewConfig.sampleRenderSize.width*e;const n=8*t.sampleViewConfig.sampleRenderSize.width,l=1;a<l||a>n||(k.value=e,await(r.value?.change_scale(a)))}async function ue(){const e=await(r.value?.flame_graph(z));e&&M.open(e)}async function de(e,t){b.value=void 0,w.value=void 0,y.value=void 0;try{const a=e.endsWith(".gz")?"Gzip":"Uncompressed";r.value?.initialize(t,a),r.value?.render(),fe()}catch(a){throw _.value="failed",x.value=a?.toString(),a}document.title=`jfrv - ${e}`,_.value="loaded"}(0,l.bv)((async()=>{const e=await a.e(672).then(a.bind(a,7672));r.value=new e.Renderer(t),k.value=1,window.addEventListener("resize",fe)})),(0,l.Ah)((()=>{window.removeEventListener("resize",fe)}));const ce=e=>{const t=i.value?.$el,a=s.value?.$el;"header"===e&&(a.scrollTop=t.scrollTop),"chart"===e&&(t.scrollTop=a.scrollTop)},fe=()=>{const e=u.value,t=d.value,a=g.value;e&&t&&a&&(e.width=i.value?.$el.getBoundingClientRect().width,e.height=i.value?.$el.getBoundingClientRect().height,e.style.left=`${i.value?.$el.getBoundingClientRect().left}px`,e.style.top=`${i.value?.$el.getBoundingClientRect().top}px`,t.width=s.value?.$el.getBoundingClientRect().width,t.height=s.value?.$el.getBoundingClientRect().height,t.style.left=`${s.value?.$el.getBoundingClientRect().left}px`,t.style.top=`${s.value?.$el.getBoundingClientRect().top}px`,a.style.width=`${t.width}px`,a.style.left=t.style.left)};return(e,t)=>((0,l.wg)(),(0,l.j4)(H,null,{default:(0,l.w5)((()=>[(0,l._)("div",W,[(0,l._)("button",{class:"hover:bg-slate-300 w-24 h-7 text-sm text-center border-2 rounded border-slate-400",onClick:t[0]||(t[0]=(...e)=>(0,c.SU)(R)&&(0,c.SU)(R)(...e))},"open file"),(0,l._)("button",{class:"hover:bg-slate-300 w-24 h-7 text-sm text-center border-2 border-slate-500 absolute right-2",onClick:ie},"load demo"),E,(0,l.wy)((0,l._)("input",{class:"h-7",type:"text",placeholder:"regex","onUpdate:modelValue":t[1]||(t[1]=e=>b.value=e),onChange:F},null,544),[[n.nr,b.value]]),D,(0,l.wy)((0,l._)("input",{class:"h-7",type:"text",placeholder:"match regex","onUpdate:modelValue":t[2]||(t[2]=e=>w.value=e),onChange:F},null,544),[[n.nr,w.value]]),I,(0,l.wy)((0,l._)("input",{class:"h-7",type:"text",placeholder:"reject regex","onUpdate:modelValue":t[3]||(t[3]=e=>y.value=e),onChange:F},null,544),[[n.nr,y.value]]),(0,l._)("input",(0,f.vs)((0,l.F4)((0,c.SU)(j)())),null,16),(0,l._)("button",{class:"disabled:opacity-50 enabled:hover:bg-slate-300 w-8 h-7 ml-2 text-sm text-center border-2 rounded border-slate-400",onClick:ue,disabled:"loaded"!==_.value},"ðŸ”¥",8,B)]),(0,l._)("div",T,[(0,l._)("button",{class:"disabled:opacity-50 enabled:hover:bg-slate-300 w-12 h-5 ml-2 text-xs text-center border-2 border-slate-400",onClick:t[4]||(t[4]=e=>se(1)),disabled:"loaded"!==_.value},"reset",8,A),(0,l._)("button",{class:"disabled:opacity-50 enabled:hover:bg-slate-300 w-5 h-5 ml-2 text-xs text-center border-2 border-slate-400",onClick:t[5]||(t[5]=e=>se(k.value/1.5)),disabled:"loaded"!==_.value},"-",8,O),(0,l._)("button",{class:"disabled:opacity-50 enabled:hover:bg-slate-300 w-5 h-5 ml-2 text-xs text-center border-2 border-slate-400",onClick:t[6]||(t[6]=e=>se(1.5*k.value)),disabled:"loaded"!==_.value},"+",8,$),(0,l._)("div",{ref_key:"timeAxis",ref:g,id:"time-axis",class:"absolute z-10 top-0 h-full"},q,512)]),(0,l._)("canvas",{ref_key:"headerOverlay",ref:u,id:"header-overlay",class:"fixed pointer-events-none z-10",width:"0",height:"0"},null,512),(0,l._)("canvas",{ref_key:"chartOverlay",ref:d,id:"chart-overlay",class:"fixed pointer-events-none z-10",width:"0",height:"0"},null,512),(0,l._)("div",P,[(0,l.Wm)((0,c.SU)(h.F),(0,l.dG)({class:"default-theme text-sm",horizontal:""},(0,c.SU)(S)(),{onResize:t[10]||(t[10]=e=>fe())}),{default:(0,l.w5)((()=>[(0,l.Wm)((0,c.SU)(h.X),null,{default:(0,l.w5)((()=>[(0,l._)("div",X,[(0,l.Wm)((0,c.SU)(h.F),{vertical:"",onResize:t[9]||(t[9]=e=>fe())},{default:(0,l.w5)((()=>[(0,l.Wm)((0,c.SU)(h.X),{size:"25",class:"overflow-x-hidden overflow-y-auto scrollbar-none relative",onScroll:t[7]||(t[7]=e=>ce("header")),ref_key:"headerPane",ref:i,id:"header-pane"},{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.iD)("svg",{ref_key:"header",ref:p,id:"header",class:"absolute top-0 left-0",onMousemove:ne,onMouseout:re,width:"0",height:"0"},null,544))])),_:1},512),(0,l.Wm)((0,c.SU)(h.X),{class:"overflow-auto relative",onScroll:t[8]||(t[8]=e=>ce("chart")),ref_key:"chartPane",ref:s,id:"chart-pane"},{default:(0,l.w5)((()=>[(0,l._)("canvas",{ref_key:"chart",ref:m,id:"thread-chart-sample-view",onMousemove:le,onMouseout:re,onClick:ae,class:"bg-slate-100",width:"0",height:"0"},null,544),_.value?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",Z,[(0,c.SU)(C)?((0,l.wg)(),(0,l.iD)("p",N,"Drop here ...")):((0,l.wg)(),(0,l.iD)("p",V,'Drag & drop OR press "open file" to select JFR file'))]))])),_:1},512)])),_:1})])])),_:1}),(0,l.Wm)((0,c.SU)(h.X),{size:"40",class:"overflow-auto"},{default:(0,l.w5)((()=>[(0,l._)("div",L,[(0,l.Wm)((0,c.SU)(h.F),{vertical:""},{default:(0,l.w5)((()=>[(0,l.Wm)((0,c.SU)(h.X),{size:"75",class:"overflow-auto"},{default:(0,l.w5)((()=>[(0,l._)("div",G,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.value?.stackTrace.frames,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"flex flex-col space-x-2 text-sm",key:t},(0,f.zw)(e.name),1)))),128))])])),_:1}),(0,l.Wm)((0,c.SU)(h.X),null,{default:(0,l.w5)((()=>[(0,l._)("div",J,[(0,l._)("table",K,[(0,l._)("tbody",null,[(0,l._)("tr",null,[Y,(0,l._)("td",null,(0,f.zw)(o.value?.timestamp),1)]),(0,l._)("tr",null,[Q,(0,l._)("td",null,(0,f.zw)(o.value?.osThreadId),1)])])])])])),_:1})])),_:1})])])),_:1})])),_:1},16)]),"loading"===_.value?((0,l.wg)(),(0,l.iD)("div",ee,"Loading...")):(0,l.kq)("",!0),"failed"===_.value?((0,l.wg)(),(0,l.iD)("div",te,"Failed to load JFR: "+(0,f.zw)(x.value),1)):(0,l.kq)("",!0)])),_:1}))}});const ne=ae;var le=ne;const re={class:"fixed top-12 left-0 right-0 h-12 bg-neutral-100 z-40 border-b border-slate-400 p-2"},oe=(0,l._)("span",{class:"h-7 ml-2"},"thread name:",-1),ie=(0,l._)("div",{class:"flex flex-col space-x-2"},null,-1),se={class:"absolute top-12 right-0 left-0 bottom-0"},ue={class:"w-full h-full"},de={ref:"header-overlay",id:"jbm-header-overlay",class:"absolute top-0 left-0 pointer-events-none",width:"0",height:"0"},ce={ref:"chart-overlay",id:"jbm-chart-overlay",class:"absolute top-0 left-0 pointer-events-none",width:"0",height:"0"},fe={key:0},he={key:0},ve={key:1},pe={class:"w-full h-full"},me={class:"p-2"},ge={class:"h-full p-2 overflow-auto"},be={class:"table-auto whitespace-nowrap"},we=(0,l._)("td",{class:"text-right"},"thread :",-1),ye=(0,l._)("td",{class:"text-right"},"offcpu start :",-1),_e=(0,l._)("td",{class:"text-right"},"offcpu end :",-1),xe=(0,l._)("td",{class:"text-right"},"duration (ms) :",-1),ke={key:0,class:"fixed w-72 h-24 bg-neutral-200 border-neutral-500 p-2 border-2 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"};var Se=(0,l.aZ)({__name:"JvmBlockingMonitor",setup(e){const t={defaultMargin:1,fontSize:14,headerConfig:{borderWidth:1,borderColorRgbHex:7368816,elementId:"jbm-header",overlayElementId:"jbm-header-overlay"},sampleViewConfig:{elementId:"jbm-thread-chart-sample-view",overlayElementId:"jbm-chart-overlay",sampleRenderHeight:8,sampleWidthPerHour:256,backgroundRgbHex:16119285},threadStateColorConfig:{stateRunnableRgbHex:7125534,stateSleepingRgbHex:8737986,stateUnknownRgbHex:7302514},overlayConfig:{rowHighlightArgbHex:1077952576,sampleHighlightRgbHex:15745140}},r=(0,c.iH)(),o=(0,c.iH)(),i=(0,c.iH)(),s=(0,c.iH)(),u=(0,c.iH)(),d=(0,c.iH)(),p=(0,c.iH)(),m=(0,c.iH)(),{getRootProps:g,getInputProps:b,isDragActive:w,open:y}=(0,v.u)({onDrop:C,multiple:!1,noClick:!0,noKeyboard:!0});function _(){m.value&&(void 0!==p.value&&p.value?.length>0?r.value?.apply_filter({threadNameRegex:p.value}):r.value?.apply_filter({threadNameRegex:null}))}function x(){o.value=r.value?.on_chart_click()}function k(e){r.value?.on_header_mouse_move(e.clientX-u.value.getBoundingClientRect().x,e.clientY-u.value.getBoundingClientRect().y)}function S(e){r.value?.on_chart_mouse_move(e.clientX-d.value.getBoundingClientRect().x,e.clientY-d.value.getBoundingClientRect().y)}function j(){r.value?.on_mouse_out()}async function C(e,t){m.value="loading";const a=await e[0].arrayBuffer(),n=new Uint8Array(a);await U(n)}async function R(){m.value="loading";const e=await fetch("/jfrv/jbm.log"),t=await e.arrayBuffer(),a=new Uint8Array(t);await U(a)}async function U(e){p.value=void 0;try{r.value?.initialize(e),r.value?.render()}catch(t){throw m.value=void 0,t}m.value="loaded"}(0,l.bv)((async()=>{const e=await a.e(672).then(a.bind(a,7672));r.value=new e.JbmRenderer(t)}));const z=e=>{const t=i.value?.$el,a=s.value?.$el;"header"===e&&(a.scrollTop=t.scrollTop),"chart"===e&&(t.scrollTop=a.scrollTop)};return(e,t)=>((0,l.wg)(),(0,l.j4)(H,null,{default:(0,l.w5)((()=>[(0,l._)("div",re,[(0,l._)("button",{class:"hover:bg-slate-300 w-24 h-7 text-sm text-center border-2 rounded border-slate-400",onClick:t[0]||(t[0]=(...e)=>(0,c.SU)(y)&&(0,c.SU)(y)(...e))},"open file"),(0,l._)("button",{class:"hover:bg-slate-300 w-24 h-7 text-sm text-center border-2 border-slate-500 absolute right-2",onClick:R},"load demo"),oe,(0,l.wy)((0,l._)("input",{class:"h-7",type:"text",placeholder:"regex","onUpdate:modelValue":t[1]||(t[1]=e=>p.value=e),onChange:_},null,544),[[n.nr,p.value]]),(0,l._)("input",(0,f.vs)((0,l.F4)((0,c.SU)(b)())),null,16),ie]),(0,l._)("div",se,[(0,l.Wm)((0,c.SU)(h.F),(0,l.dG)({class:"default-theme text-sm",horizontal:""},(0,c.SU)(g)()),{default:(0,l.w5)((()=>[(0,l.Wm)((0,c.SU)(h.X),null,{default:(0,l.w5)((()=>[(0,l._)("div",ue,[(0,l.Wm)((0,c.SU)(h.F),{vertical:""},{default:(0,l.w5)((()=>[(0,l.Wm)((0,c.SU)(h.X),{size:"25",class:"overflow-x-hidden overflow-y-auto scrollbar-none relative",onScroll:t[2]||(t[2]=e=>z("header")),ref_key:"headerPane",ref:i},{default:(0,l.w5)((()=>[(0,l._)("canvas",de,null,512),((0,l.wg)(),(0,l.iD)("svg",{ref_key:"header",ref:u,id:"jbm-header",class:"absolute top-0 left-0",onMousemove:k,onMouseout:j,width:"0",height:"0"},null,544))])),_:1},512),(0,l.Wm)((0,c.SU)(h.X),{class:"overflow-auto relative",onScroll:t[3]||(t[3]=e=>z("chart")),ref_key:"chartPane",ref:s},{default:(0,l.w5)((()=>[(0,l._)("canvas",ce,null,512),(0,l._)("canvas",{ref_key:"chart",ref:d,id:"jbm-thread-chart-sample-view",onMousemove:S,onMouseout:j,onClick:x,class:"bg-slate-100",width:"0",height:"0"},null,544),m.value?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",fe,[(0,c.SU)(w)?((0,l.wg)(),(0,l.iD)("p",he,"Drop here ...")):((0,l.wg)(),(0,l.iD)("p",ve,'Drag & drop OR press "open file" to select jbm log file'))]))])),_:1},512)])),_:1})])])),_:1}),(0,l.Wm)((0,c.SU)(h.X),{size:"40"},{default:(0,l.w5)((()=>[(0,l._)("div",pe,[(0,l.Wm)((0,c.SU)(h.F),{vertical:""},{default:(0,l.w5)((()=>[(0,l.Wm)((0,c.SU)(h.X),{size:"75",class:"overflow-auto"},{default:(0,l.w5)((()=>[(0,l._)("div",me,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.value?.stackTrace?.frames,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"flex flex-col space-x-2 text-sm",key:t},(0,f.zw)(e.name),1)))),128))])])),_:1}),(0,l.Wm)((0,c.SU)(h.X),null,{default:(0,l.w5)((()=>[(0,l._)("div",ge,[(0,l._)("table",be,[(0,l._)("tbody",null,[(0,l._)("tr",null,[we,(0,l._)("td",null,(0,f.zw)(o.value?.threadName),1)]),(0,l._)("tr",null,[ye,(0,l._)("td",null,(0,f.zw)(o.value?.offcpuStart),1)]),(0,l._)("tr",null,[_e,(0,l._)("td",null,(0,f.zw)(o.value?.offcpuEnd),1)]),(0,l._)("tr",null,[xe,(0,l._)("td",null,(0,f.zw)(o.value?.durationMillis),1)])])])])])),_:1})])),_:1})])])),_:1})])),_:1},16)]),"loading"===m.value?((0,l.wg)(),(0,l.iD)("div",ke,"Loading...")):(0,l.kq)("",!0)])),_:1}))}});const je=Se;var Ce=je;const He=e=>((0,l.dD)("data-v-787045bb"),e=e(),(0,l.Cn)(),e),Re=He((()=>(0,l._)("canvas",{id:"flame-graph"},null,-1))),Ue=He((()=>(0,l._)("div",{id:"highlight"},[(0,l._)("span",{id:"highlight-text"})],-1))),ze=He((()=>(0,l._)("p",{class:"mt-[5px] mr-0 mb-[5px] ml-0",id:"status"},null,-1))),Me=[Re,Ue,ze];var We=(0,l.aZ)({__name:"FlameGraph",setup(e){return(0,l.bv)((async()=>{window.addEventListener("load",(async()=>{const e=await a.e(672).then(a.bind(a,7672)),t=await M.flameGraph(),n=new e.FlameGraphRenderer(t,z);window.onmousemove=e=>{n.onmousemove(e)},window.onmouseout=e=>{n.onmouseout(e)},window.onclick=e=>{n.onclick(e)},n.render()}))})),(e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"m-0 p-[10px] bg-white",style:(0,f.j5)(`font: ${(0,c.SU)(z).font}`)},Me,4))}});const Ee=(0,o.Z)(We,[["__scopeId","data-v-787045bb"]]);var De=Ee;const Ie=["onClick"];var Be={__name:"TreeNode",props:{data:Array},setup(e){const t=(0,c.iH)({});function a(e){t.value[e]=!t.value[e]}return(n,r)=>{const o=(0,l.up)("TreeNode",!0);return(0,l.wg)(),(0,l.iD)("div",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.data,((e,n)=>((0,l.wg)(),(0,l.iD)("div",{key:n},[(0,l._)("span",{onClick:e=>a(n),class:(0,f.C_)("whitespace-pre"+(e.columns?" cursor-pointer":""))},(0,f.zw)(e.columns?t.value[n]?"[-]":"[+]":"      *")+" "+(0,f.zw)(e.type?`${e.name}: ${e.type}`:e.name),11,Ie),t.value[n]&&e.columns?((0,l.wg)(),(0,l.j4)(o,{key:0,data:e.columns,class:"whitespace-nowrap"},null,8,["data"])):(0,l.kq)("",!0)])))),128))])}}};const Te=Be;var Ae=Te,Oe=a(3443),$e=a(8773),Fe=a(8191),qe=a(5533),Pe=a(8139),Xe=a(4413),Ze=a(4909),Ne=a(6906);const Ve={mvp:{mainModule:Xe,mainWorker:new URL(a(3123),a.b).toString()}};class Le{constructor(){(0,R.Z)(this,"db",void 0),(0,R.Z)(this,"cid",void 0);const e=new Worker(Ve.mvp.mainWorker),t=new Pe.kw(Pe["in"].WARNING);this.db=new Pe.ak(t,e)}async init(){await this.db.instantiate(Ve.mvp.mainModule,Ve.mvp.mainWorker),this.cid=await this.db.connectInternal()}async query(e){return void 0===this.cid&&await this.init(),await this.db.runQuery(this.cid,e)}async registerFile(e,t){return await this.db.dropFile(e),this.db.registerFileBuffer(e,t)}async schema(){const e={tables:[]},t=new Ze.iA(Ne.so.from((await this.query("show tables")).buffer)).toArray();for(let a=0;a<t.length;a++){const n=t[a]["name"],l={name:n,columns:[]};new Ze.iA(Ne.so.from((await this.query(`pragma show('"${n}"')`)).buffer)).toArray().forEach((e=>{const t=e["column_name"],a=e["column_type"];l.columns.push({name:t,type:a})})),e.tables.push(l)}return e}getFile(e){return this.db.copyFileToBuffer(e)}}var Ge=a(5587);class Je extends HTMLElement{constructor(){super(),(0,R.Z)(this,"grid",void 0)}connectedCallback(){}disconnectedCallback(){}async activate(e){this.grid||(this.grid=new Ge.rj({columns:[],sort:!0,resizable:!0,fixedHeader:!0,height:"100%",data:[],style:{th:{"background-color":"#fdf6e3",padding:"0.5em"},td:{"background-color":"rgb(245 245 245)",padding:"0.2em"},container:{padding:"0.5em","border-radius":"0",position:"absolute",top:"0",left:"0",right:"0",bottom:"0"},header:{"border-radius":"0"},footer:{"border-radius":"0"}},className:{table:"text-xs",td:"whitespace-pre-wrap"}}).render(this));const t=await(this.parentElement?.getTable()),a=await t.columns(),n=await e.to_json(),l=[];n.forEach((e=>{const t=[];a.forEach((a=>{t.push(e[a])})),l.push(t)})),this.grid.updateConfig({columns:a,data:l}),this.grid.forceRender()}get name(){return"Datagrid"}get category(){return"Basic"}get select_mode(){return"toggle"}get config_column_names(){return["Columns"]}get priority(){return 1}async draw(e){return this.activate(e)}async update(e){return this.activate(e)}async resize(){}async clear(){}save(){return""}restore(e){}async restyle(e){}delete(){}}var Ke=a(1957);const Ye={class:"fixed top-12 left-0 right-0 h-12 bg-neutral-100 z-40 border-b border-slate-400 p-2"},Qe=["disabled"],et={class:"h-7 ml-2 text-xs"},tt=(0,l._)("div",{class:"flex flex-col space-x-2"},null,-1),at={class:"absolute top-12 right-0 left-0 bottom-0"},nt={class:"m-2 text-xs"},lt={class:"w-full h-full overflow-auto"},rt={class:"w-full h-full overflow-auto"},ot={key:0,class:"w-full h-full text-xs p-2 text-red-500"},it={key:0,class:"fixed w-72 h-24 bg-neutral-200 border-neutral-500 p-2 border-2 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},st={key:1,class:"fixed w-72 h-24 bg-neutral-200 border-neutral-500 p-2 border-2 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"};var ut=(0,l.aZ)({__name:"JfrQuery",setup(e){const t=(0,c.iH)(),a=(0,c.iH)(""),n=(0,c.iH)(""),r=(0,c.iH)(),o=(0,c.iH)(""),i=(0,c.iH)(),s=(0,c.iH)({tables:[]}),{getRootProps:u,getInputProps:d,open:p}=(0,v.u)({onDrop:b,multiple:!1,noClick:!0,noKeyboard:!0,accept:[".jfr",".gz"]});function m(){return Fe.zf.define({...Fe.ey.spec,keywords:Fe.ey.spec.keywords?.concat(" jfr_attach"," jfr_scan")})}async function g(){t.value="executing";const e=await i.value.query(o.value).catch((e=>{throw t.value="failed",a.value=e.toString(),e}));t.value="loaded",s.value=await i.value.schema();const n=Oe.ZP.worker(),l=Ne.so.from(e.buffer),u={},d=new Ze.iA(l);d.schema.fields.forEach((e=>{try{let t="string",a=e=>e.toString();const n=e.type.toString();"Bool"===n?(t="boolean",a=e=>e):n.startsWith("Float")?(t="float",a=e=>e):n.startsWith("Int")?(t="integer",a=e=>e):n.startsWith("Timestamp")?(t="string",a=e=>(0,Ke.Z)(e,"yyyy-MM-dd HH:mm:ss.SSS")):"Date"===n&&(t="string",a=e=>(0,Ke.Z)(e,"yyyy-MM-dd")),u[e.name]={tableType:t,converter:a}}catch(n){throw t.value="failed",a.value=n.toString(),n}}));const c=[];d.toArray().forEach((e=>{const t={};Object.entries(u).forEach((([a,n])=>{const l=e[a];t[a]=[n.converter(l)]})),c.push(t)}));const f={};Object.entries(u).forEach((([e,t])=>{f[e]=t.tableType}));const h=await n.table(f);d.numRows>0&&h.update(c),await(r.value?.load(h)),r.value?.reset()}async function b(e,a){t.value="loading";const n=e[0],l=await n.arrayBuffer();await y(n.name,new Uint8Array(l))}async function w(){t.value="loading";const e=await fetch("/jfrv/demo.jfr"),a=await e.arrayBuffer(),n=new Uint8Array(a);await y("demo.jfr",n)}async function y(e,l){await(i.value?.registerFile(e,l).catch((e=>{throw t.value="failed",a.value=e.toString(),e}))),await(i.value?.query(`call jfr_attach('${e}')`).catch((e=>{throw t.value="failed",a.value=e.toString(),e}))),t.value="loaded",n.value=e,s.value=await i.value.schema()}return customElements.define("jfr-datagrid",Je),customElements.whenDefined("jfr-datagrid").then((()=>{customElements.get("perspective-viewer").registerPlugin("jfr-datagrid")})),(0,l.bv)((async()=>{i.value=new Le,await(i.value?.init())})),(e,i)=>{const v=(0,l.up)("perspective-viewer");return(0,l.wg)(),(0,l.j4)(H,null,{default:(0,l.w5)((()=>[(0,l._)("div",Ye,[(0,l._)("button",{class:"hover:bg-slate-300 w-24 h-7 text-sm text-center border-2 rounded border-slate-400",onClick:i[0]||(i[0]=(...e)=>(0,c.SU)(p)&&(0,c.SU)(p)(...e))},"open file"),(0,l._)("button",{class:"disabled:opacity-50 enabled:hover:bg-slate-300 w-24 h-7 ml-2 text-sm text-center border-2 rounded border-slate-400",onClick:g,disabled:"executing"===t.value},"Run query",8,Qe),(0,l._)("span",et,"file name: "+(0,f.zw)(n.value),1),(0,l._)("button",{class:"hover:bg-slate-300 w-24 h-7 text-sm text-center border-2 border-slate-500 absolute right-2",onClick:w},"load demo"),(0,l._)("input",(0,f.vs)((0,l.F4)((0,c.SU)(d)())),null,16),tt]),(0,l._)("div",at,[(0,l.Wm)((0,c.SU)(h.F),(0,l.dG)({class:"default-theme text-sm",horizontal:""},(0,c.SU)(u)()),{default:(0,l.w5)((()=>[(0,l.Wm)((0,c.SU)(h.X),null,{default:(0,l.w5)((()=>[(0,l.Wm)((0,c.SU)(h.F),{vertical:""},{default:(0,l.w5)((()=>[(0,l.Wm)((0,c.SU)(h.X),{size:"20",class:"overflow-auto"},{default:(0,l.w5)((()=>[(0,l._)("div",nt,[(0,l.Wm)(Ae,{data:s.value.tables},null,8,["data"])])])),_:1}),(0,l.Wm)((0,c.SU)(h.X),null,{default:(0,l.w5)((()=>[(0,l._)("div",lt,[(0,l.Wm)((0,c.SU)($e.Z1),{modelValue:o.value,"onUpdate:modelValue":i[1]||(i[1]=e=>o.value=e),placeholder:'Enter query...  (Drag & drop OR press "open file" to attach jfr file)',extensions:[(0,c.SU)(Fe.i6)({dialect:m()}),(0,c.SU)(qe.$f).of([{key:"Ctrl-Enter",run:()=>(g(),!0)}])]},null,8,["modelValue","placeholder","extensions"])])])),_:1})])),_:1})])),_:1}),(0,l.Wm)((0,c.SU)(h.X),{size:"50"},{default:(0,l.w5)((()=>[(0,l._)("div",rt,["failed"===t.value?((0,l.wg)(),(0,l.iD)("div",ot,[(0,l._)("pre",null,(0,f.zw)(a.value)+"\n              ",1)])):((0,l.wg)(),(0,l.j4)(v,{key:1,class:"w-full h-full",ref_key:"queryViewer",ref:r,id:"query-viewer"},null,512))])])),_:1})])),_:1},16)]),"loading"===t.value?((0,l.wg)(),(0,l.iD)("div",it,"Loading...")):(0,l.kq)("",!0),"executing"===t.value?((0,l.wg)(),(0,l.iD)("div",st,"Executing...")):(0,l.kq)("",!0)])),_:1})}}});const dt=ut;var ct=dt;const ft=[{path:"/",redirect:"/execution-sample"},{path:"/execution-sample",name:"execution-sample",component:le},{path:"/jbm",name:"jbm",component:Ce},{path:"/jfr-query",name:"jfr-query",component:ct},{path:"/flame-graph",name:"flame-graph",component:De}],ht=(0,d.p7)({history:(0,d.r5)("/jfrv/"),routes:ft});var vt=ht,pt=(a(5109),a(1210),a(1884));(0,n.ri)(u).use(vt).use($e.ZP,{extensions:[pt.Xy]}).mount("#app")}},t={};function a(n){var l=t[n];if(void 0!==l)return l.exports;var r=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=e,function(){var e="function"===typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"===typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"===typeof Symbol?Symbol("webpack error"):"__webpack_error__",l=function(e){e&&!e.d&&(e.d=1,e.forEach((function(e){e.r--})),e.forEach((function(e){e.r--?e.r++:e()})))},r=function(a){return a.map((function(a){if(null!==a&&"object"===typeof a){if(a[e])return a;if(a.then){var r=[];r.d=0,a.then((function(e){o[t]=e,l(r)}),(function(e){o[n]=e,l(r)}));var o={};return o[e]=function(e){e(r)},o}}var i={};return i[e]=function(){},i[t]=a,i}))};a.a=function(a,o,i){var s;i&&((s=[]).d=1),s&&(s.moduleId=a.id);var u,d,c,f=new Set,h=a.exports,v=new Promise((function(e,t){c=t,d=e}));v[t]=h,v[e]=function(e){s&&e(s),f.forEach(e),v["catch"]((function(){}))},v.moduleId=a.id,a.exports=v,o((function(a){var l;u=r(a);var o=function(){return u.map((function(e){if(e[n])throw e[n];return e[t]}))},i=new Promise((function(t){l=function(){t(o)},l.r=0;var a=function(e){e!==s&&!f.has(e)&&(f.add(e),e&&!e.d&&(l.r++,e.push(l)))};u.map((function(t){t[e](a)}))}));return l.r?i:o()}),(function(e){e?c(v[n]=e):d(h),l(s)})),s&&(s.d=0)}}(),function(){var e=[];a.O=function(t,n,l,r){if(!n){var o=1/0;for(d=0;d<e.length;d++){n=e[d][0],l=e[d][1],r=e[d][2];for(var i=!0,s=0;s<n.length;s++)(!1&r||o>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[s])}))?n.splice(s--,1):(i=!1,r<o&&(o=r));if(i){e.splice(d--,1);var u=l();void 0!==u&&(t=u)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,l,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,n){return a.f[n](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+e+".90f2b4da.js"}}(),function(){a.miniCssF=function(e){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="jfrv:";a.l=function(n,l,r,o){if(e[n])e[n].push(l);else{var i,s;if(void 0!==r)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var c=u[d];if(c.getAttribute("src")==n||c.getAttribute("data-webpack")==t+r){i=c;break}}i||(s=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",t+r),i.src=n),e[n]=[l];var f=function(t,a){i.onerror=i.onload=null,clearTimeout(h);var l=e[n];if(delete e[n],i.parentNode&&i.parentNode.removeChild(i),l&&l.forEach((function(e){return e(a)})),t)return t(a)},h=setTimeout(f.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=f.bind(null,i.onerror),i.onload=f.bind(null,i.onload),s&&document.head.appendChild(i)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.v=function(e,t,n,l){var r=fetch(a.p+""+n+".module.wasm");return"function"===typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(r,l).then((function(t){return Object.assign(e,t.instance.exports)})):r.then((function(e){return e.arrayBuffer()})).then((function(e){return WebAssembly.instantiate(e,l)})).then((function(t){return Object.assign(e,t.instance.exports)}))}}(),function(){a.p="/jfrv/"}(),function(){a.b=document.baseURI||self.location.href;var e={143:0};a.f.j=function(t,n){var l=a.o(e,t)?e[t]:void 0;if(0!==l)if(l)n.push(l[2]);else{var r=new Promise((function(a,n){l=e[t]=[a,n]}));n.push(l[2]=r);var o=a.p+a.u(t),i=new Error,s=function(n){if(a.o(e,t)&&(l=e[t],0!==l&&(e[t]=void 0),l)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",i.name="ChunkLoadError",i.type=r,i.request=o,l[1](i)}};a.l(o,s,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,n){var l,r,o=n[0],i=n[1],s=n[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(l in i)a.o(i,l)&&(a.m[l]=i[l]);if(s)var d=s(a)}for(t&&t(n);u<o.length;u++)r=o[u],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},n=self["webpackChunkjfrv"]=self["webpackChunkjfrv"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(8617)}));n=a.O(n)})();
//# sourceMappingURL=app.3c0642ad.js.map